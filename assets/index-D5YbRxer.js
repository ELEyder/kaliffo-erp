import{r as a,j as e,L as F}from"./index-5R_ouSBL.js";import{b as S,c as E}from"./Lote-Bl9cVKlX.js";import{f as k}from"./Tela-DF0mm3Pl.js";import{g as O}from"./Producto-BYzNbulg.js";import{F as L}from"./index-DLbrpSsl.js";import{M as R}from"./index-ByydEJTS.js";import{S as C}from"./index-DIKG1Ll8.js";import{D as T}from"./index-B2sBOT07.js";import{R as y,C as d}from"./row-C04RvAS0.js";import{B as w}from"./button-jOS5C1LE.js";import{T as M}from"./index-Mvhg0UnF.js";import{F as q}from"./index-dLOo5b7D.js";import{C as b}from"./index-BxKwJ1Pm.js";import{T as D}from"./index-CXxVIYtY.js";import{F as $}from"./index-Dw2B-dtn.js";import{R as B}from"./index-mU7rwK2D.js";import"./ApiClient-CULQ52Ii.js";import"./ContextIsolator-N8O_ycp3.js";import"./useSize-QLyh_IgM.js";import"./EllipsisOutlined-D8t1qCe4.js";import"./useMergedState-jngh2BvR.js";import"./responsiveObserver-BgaHbeJ9.js";import"./ActionButton-DT92tj6F.js";import"./Skeleton-Czx_vdt8.js";import"./TextArea-CTbE0_w0.js";import"./CheckOutlined-BphA7G9z.js";import"./DownOutlined-DAzCnoiM.js";import"./EditOutlined-BnoZX-tN.js";import"./styleChecker-BlD5v5Ci.js";import"./gapSize-U1swVQyS.js";import"./scrollTo-DYPVaqh4.js";import"./Dropdown-C0K2GNPB.js";const N=({openModal:x,closeModal:f,reload:h})=>{const{Title:u}=M,[m]=L.useForm(),[j,g]=a.useState([]),[i,s]=a.useState({}),[l,c]=a.useState("");a.useEffect(()=>{O(g)},[]),a.useEffect(()=>{const t=r=>{r.key==="Enter"?l.trim()!==""&&(k(l).then(o=>{o&&(Object.values(i).flat().some(({tela_id:n})=>o.tela_id===n)||s(n=>({...n,[o.tipo]:[...n[o.tipo]||[],o]})))}),c("")):c(o=>o+r.key)};return document.addEventListener("keypress",t),()=>{document.removeEventListener("keypress",t)}},[l]);const p=Object.values(i).flat().map(({tela_id:t})=>t).join(","),v=Object.values(i).flat().reduce((t,{metraje:r})=>t+Number(r),0).toFixed(2),A=(t,r)=>{s(o=>({...o,[r]:o[r].filter(n=>n.tela_id!==t)}))};return e.jsx(R,{title:"Nuevo Lote",open:x,onCancel:()=>f(!1),okText:"CREAR",onOk:m.submit,centered:!0,width:400,children:e.jsxs(L,{form:m,layout:"vertical",onFinish:async t=>{await S(t,p,v),c(""),s({}),m.resetFields(),h(),f(!1)},children:[e.jsx(L.Item,{name:"productos",label:"Productos",rules:[{required:!0,message:"Seleccione al menos un producto"}],children:e.jsx(C,{mode:"multiple",placeholder:"Seleccione productos",children:j.map((t,r)=>e.jsx(C.Option,{value:t.producto_id,children:t.nombre},r))})}),e.jsx(T,{}),e.jsxs(y,{gutter:16,justify:"center",align:"middle",children:[e.jsxs(d,{span:24,style:{textAlign:"center"},children:[e.jsx(u,{style:{color:"white"},level:3,children:"Telas"}),e.jsxs("span",{style:{color:"white"},children:["METRAJE USADO: ",v]})]}),e.jsx(d,{span:24,children:Object.entries(i).map(([t,r])=>e.jsxs(y,{style:{padding:"10px 20px",backgroundColor:"#1e1e2f",borderRadius:"8px"},children:[e.jsx(d,{span:6,style:{textAlign:"center",color:"#fff",textTransform:"uppercase"},children:e.jsxs("span",{style:{fontSize:"1rem",fontWeight:"bold"},children:[t,":"]})}),e.jsx(d,{span:18,children:e.jsx(y,{gutter:[0,8],justify:"end",children:r.map((o,n)=>e.jsxs(e.Fragment,{children:[e.jsx(d,{span:24,style:{textAlign:"right",color:"#fff",paddingLeft:"15px"},children:e.jsxs("span",{children:[e.jsxs("strong",{children:["CODIGO TELA: ",o.codigo_tela]})," ","METRAJE: ",o.metraje," M"]})},n),e.jsx(d,{children:e.jsx(w,{onClick:()=>A(o.tela_id,t),children:"X"})})]}))})})]},t))})]})]})})},P="_cardLoteIcons_fjyqf_1",J="_cardLoteIcon_fjyqf_1",z="_cardSvgLote_fjyqf_51",G="_loteIcons_fjyqf_63",U="_loteIcon_fjyqf_63",V="_svgLote_fjyqf_109",_={cardLoteIcons:P,cardLoteIcon:J,cardSvgLote:z,loteIcons:G,loteIcon:U,svgLote:V},{Meta:I}=b,W=()=>{const[x,f]=a.useState([]),[h,u]=a.useState(!1),m=["white","#9481fe","#49adfe","#ff7655","#7bfe56"],[j,g]=a.useState(!1),i=[{title:"Corte",url:"corte"},{title:"Lavandería",url:"lavanderia"},{title:"Taller de Acabados Finales",url:"acabados"},{title:"Almacén",url:"almacen"}];return a.useEffect(()=>{E(f)},[j]),e.jsxs(e.Fragment,{children:[e.jsx(q,{wrap:!0,gap:"middle",justify:"center",children:x.map(s=>{const l=Array(s.estado+1).fill(m[s.estado]);return l.push(...Array(4-s.estado).fill("white")),e.jsx(F,{to:`/lotes/${s.lote_id}/${i[s.estado-1].url}`,style:{textDecoration:"none"},children:e.jsxs(b,{style:{width:"300px",textAlign:"center"},title:`LOTE ${s.lote_id}`,children:[e.jsx(I,{title:`Fecha de Creación: ${s.fecha_creacion}`}),e.jsx("br",{}),e.jsx(I,{title:`Cantidad Total: ${s.cantidad_total}`}),e.jsx("div",{className:_.cardLoteIcons,children:i.map((c,p)=>e.jsx(D,{title:c.title,children:e.jsx("div",{className:_.cardLoteIcon,style:{backgroundColor:l[p+1]},children:e.jsx("img",{className:_.cardSvgLote,src:`/svg/lote/${p+1}.svg`,alt:c.title})})},p))})]})},s.lote_id)})}),e.jsx($,{tooltip:"Añadir Lote",icon:e.jsx(B,{}),onClick:()=>u(!0)}),e.jsx(N,{openModal:h,closeModal:()=>u(!1),reload:()=>g(!j)})]})},be=()=>e.jsxs(e.Fragment,{children:[e.jsx(T,{style:{textTransform:"uppercase"},children:" Lotes "}),e.jsx(W,{})]});export{be as default};
