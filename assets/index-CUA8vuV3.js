import{r as a,j as e,L as b}from"./index-DnZSuapv.js";import{a as E,g as F}from"./Lote-DgymCvQp.js";import{f as k}from"./Tela-BRYOhLqf.js";import{g as O}from"./Producto-Cd6i44JA.js";import{F as g}from"./index-eEjfzd7p.js";import{M as R}from"./index-CQoRxuqN.js";import{S as v}from"./index-CAw0ik1A.js";import{D as I}from"./index-DnZuPcqL.js";import{R as L,C as d}from"./row-Bgu54Vpq.js";import{B as M}from"./button-DxAvYtf7.js";import{T as w}from"./index-CU-hXdd1.js";import{F as q}from"./index-BjGP48R2.js";import{C as T}from"./index-BLOaBrrf.js";import{T as D}from"./index-OoAlQgr1.js";import{F as B}from"./index-CRStyn0e.js";import{R as N}from"./index-rbW2pF-2.js";import"./apiClient-DNqqoRi2.js";import"./ContextIsolator-X51Zuf7C.js";import"./useSize-DL9WfM8p.js";import"./EllipsisOutlined-BC2kcC9O.js";import"./useMergedState-xnIRtK6W.js";import"./responsiveObserver-P31G7zPC.js";import"./ActionButton-HZPJWirw.js";import"./Skeleton-C8RXkADb.js";import"./TextArea-D6coABml.js";import"./CheckOutlined-CxFn5oU1.js";import"./DownOutlined-DfCZxesi.js";import"./EditOutlined-Bm2pbz4p.js";import"./styleChecker-BPMTEHVB.js";import"./gapSize-U1swVQyS.js";import"./scrollTo-DvbmuEp_.js";const P=({openModal:j,closeModal:p,reload:x})=>{const{Title:f}=w,[m]=g.useForm(),[u,h]=a.useState([]),[s,c]=a.useState({}),[l,i]=a.useState("");a.useEffect(()=>{O(h)},[]),a.useEffect(()=>{const t=r=>{r.key==="Enter"?l.trim()!==""&&(k(l).then(o=>{o&&(Object.values(s).flat().some(({tela_id:n})=>o.tela_id===n)||c(n=>({...n,[o.tipo]:[...n[o.tipo]||[],o]})))}),i("")):i(o=>o+r.key)};return document.addEventListener("keypress",t),()=>{document.removeEventListener("keypress",t)}},[l]);const A=Object.values(s).flat().map(({tela_id:t})=>t).join(","),_=Object.values(s).flat().reduce((t,{metraje:r})=>t+Number(r),0).toFixed(2),S=(t,r)=>{c(o=>({...o,[r]:o[r].filter(n=>n.tela_id!==t)}))};return e.jsx(R,{title:"Nuevo Lote",open:j,onCancel:()=>p(!1),okText:"CREAR",onOk:m.submit,centered:!0,width:400,children:e.jsxs(g,{form:m,layout:"vertical",onFinish:async t=>{await E(t,A,_),i(""),c({}),m.resetFields(),x(),p(!1)},children:[e.jsx(g.Item,{name:"productos",label:"Productos",rules:[{required:!0,message:"Seleccione al menos un producto"}],children:e.jsx(v,{mode:"multiple",placeholder:"Seleccione productos",children:u.map((t,r)=>e.jsx(v.Option,{value:t.producto_id,children:t.nombre},r))})}),e.jsx(I,{}),e.jsxs(L,{gutter:16,justify:"center",align:"middle",children:[e.jsxs(d,{span:24,style:{textAlign:"center"},children:[e.jsx(f,{level:3,children:"Telas"}),e.jsxs("span",{children:["METRAJE USADO: ",_]})]}),e.jsx(d,{span:24,children:Object.entries(s).map(([t,r])=>e.jsxs(L,{style:{padding:"10px 20px",backgroundColor:"#1e1e2f",borderRadius:"8px"},children:[e.jsx(d,{span:6,style:{textAlign:"center",color:"#fff",textTransform:"uppercase"},children:e.jsxs("span",{style:{fontSize:"1rem",fontWeight:"bold"},children:[t,":"]})}),e.jsx(d,{span:18,children:e.jsx(L,{gutter:[0,8],justify:"end",children:r.map((o,n)=>e.jsxs(e.Fragment,{children:[e.jsx(d,{span:24,style:{textAlign:"right",color:"#fff",paddingLeft:"15px"},children:e.jsxs("span",{children:[e.jsxs("strong",{children:["CODIGO TELA: ",o.codigo_tela]})," ","METRAJE: ",o.metraje," M"]})},n),e.jsx(d,{children:e.jsx(M,{onClick:()=>S(o.tela_id,t),children:"X"})})]}))})})]},t))})]})]})})},$="_cardLoteIcons_fjyqf_1",J="_cardLoteIcon_fjyqf_1",z="_cardSvgLote_fjyqf_51",G="_loteIcons_fjyqf_63",U="_loteIcon_fjyqf_63",V="_svgLote_fjyqf_109",y={cardLoteIcons:$,cardLoteIcon:J,cardSvgLote:z,loteIcons:G,loteIcon:U,svgLote:V},{Meta:C}=T,W=()=>{const[j,p]=a.useState([]),[x,f]=a.useState(!1),m=["white","#9481fe","#49adfe","#ff7655","#7bfe56"],[u,h]=a.useState(!1);return a.useEffect(()=>{F(p)},[u]),e.jsxs(e.Fragment,{children:[e.jsx(q,{wrap:!0,gap:"middle",justify:"center",children:j.map(s=>{const c=Array(s.estado+1).fill(m[s.estado]);return c.push(...Array(4-s.estado).fill("white")),e.jsx(b,{to:`/prod/lotes/${s.lote_id}`,style:{textDecoration:"none"},children:e.jsxs(T,{style:{width:"300px",textAlign:"center"},title:`LOTE ${s.lote_id}`,children:[e.jsx(C,{title:`Fecha de Creación: ${s.fecha_creacion}`}),e.jsx("br",{}),e.jsx(C,{title:`Cantidad Total: ${s.cantidad_total}`}),e.jsx("div",{className:y.cardLoteIcons,children:["Corte","Lavandería","Taller de Acabados Finales","Almacen"].map((l,i)=>e.jsx(D,{title:l,children:e.jsx("div",{className:y.cardLoteIcon,style:{backgroundColor:c[i+1]},children:e.jsx("img",{className:y.cardSvgLote,src:`/svg/lote/${i+1}.svg`,alt:l})})},i))})]})},s.lote_id)})}),e.jsx(B,{tooltip:"Añadir Lote",icon:e.jsx(N,{}),onClick:()=>f(!0)}),e.jsx(P,{openModal:x,closeModal:()=>f(!1),reload:()=>h(!u)})]})},Te=()=>e.jsxs(e.Fragment,{children:[e.jsx(I,{style:{textTransform:"uppercase"},children:" Lotes "}),e.jsx(W,{})]});export{Te as default};
