import{e as v,r as n,b as w,j as e,d as W,O as H}from"./index-VOe2vgqy.js";import{g as N,c as L,a as U}from"./Corte-BdCkil7m.js";import{g as z,c as T}from"./Lavanderia-CVL9Jvvv.js";import{g as q,c as F}from"./Acabado-DA1DuV2E.js";import{F as p}from"./index-CC7smcAL.js";import{M as k}from"./index-Bx1_JYha.js";import{C as $}from"./index-CbSnFLG8.js";import{R as D,C as S}from"./row-B9VIZwhG.js";import{T as M}from"./index-9ycKRVJ7.js";import{I as E}from"./index-DN4pQfum.js";import{D as A}from"./index-BK0r8Jws.js";import{B as R}from"./button-BkK1HIrY.js";import{g as J}from"./Tienda-DnH4FuDy.js";import{a as K}from"./ApiClient-DPIxiZ71.js";import{d as Q}from"./Usuario-iB7HlP0j.js";import{S as O}from"./index-MILUAy1A.js";import{g as X,a as Y}from"./Lote-vLrWeXzX.js";import{T as Z}from"./index-CpO96mgP.js";import{F as ee}from"./index-D27eMH57.js";import"./ContextIsolator-BCW6I3vM.js";import"./useSize-C1OhOW7A.js";import"./EllipsisOutlined-Dvj6DMPu.js";import"./useMergedState-BLg108Rf.js";import"./responsiveObserver-NkQ2BBL7.js";import"./ActionButton-CE2oHsTL.js";import"./Skeleton-CmZq7VAa.js";import"./index-DgHYd8On.js";import"./Dropdown-C9Rkt24_.js";import"./DownOutlined-qBagt-Zf.js";import"./TextArea-YowM3xaT.js";import"./EyeOutlined-CS0JsWFM.js";import"./moment-C0VIUrQK.js";import"./CheckOutlined-DNK-T4Ox.js";import"./gapSize-U1swVQyS.js";const te="_cardLoteIcons_fjyqf_1",ae="_cardLoteIcon_fjyqf_1",se="_cardSvgLote_fjyqf_51",re="_loteIcons_fjyqf_63",oe="_loteIcon_fjyqf_63",ne="_svgLote_fjyqf_109",I={cardLoteIcons:te,cardLoteIcon:ae,cardSvgLote:se,loteIcons:re,loteIcon:oe,svgLote:ne},le=({openModal:l,closeModal:a,reload:t,fase:u,status:o})=>{const[r]=p.useForm(),{id:s}=v(),[g,i]=n.useState([]),[f,h]=n.useState(""),x=w();n.useEffect(()=>{switch(u){case 1:h("Corte"),N(s,i,r);break;case 2:h("Lavanderia"),z(s,i,r);break;case 3:h("Acabado"),q(s,i,r);break}},[s,t]);const d=async()=>{try{const m=r.getFieldsValue().items;switch(console.log("Values:",m),u){case 1:await L(s,m),(o==2||o==3)&&x(`/lotes/${s}/lavanderia`),t();break;case 2:await T(s,m),(o==2||o==3)&&x(`/lotes/${s}/acabados`),t();break;case 3:await F(s,m),(o==2||o==3)&&x(`/lotes/${s}/almacen`),t();break;default:t();break}r.resetFields(),t(),a()}catch(m){console.error("Error al guardar:",m)}},j={textAlign:"center"},c={textAlign:"center"};return e.jsx(k,{forceRender:!0,getContainer:!1,styles:{header:{textAlign:"center"}},title:"MERCADERÍA RECIBIDA",open:l,onCancel:a,footer:null,children:e.jsxs(p,{form:r,layout:"vertical",name:"addProductos",style:{maxWidth:600,display:"flex",flexDirection:"column"},autoComplete:"off",children:[e.jsx(p.List,{name:"items",children:()=>e.jsx("div",{style:{display:"flex",flexDirection:"column",rowGap:20},children:g.map((m,_)=>e.jsxs($,{size:"small",title:`${f} ${_+1}`,style:j,children:[e.jsxs(D,{justify:"center",children:[e.jsxs(S,{span:24,style:c,children:[m.detallesCorte," "]}),e.jsx(S,{span:24,children:e.jsx(p.Item,{label:"Cantidad Recibida",name:[_,"cantidad_recibida"],rules:[{required:!0,message:"Ingrese una cantidad válida"}],children:e.jsx(M,{style:{width:"100%"},max:m.cantidad_recibida})})})]}),e.jsx(E,{type:"hidden",name:[_,"id"]})," "]},_))})}),e.jsx(A,{})," ",e.jsx(p.Item,{children:e.jsx(R,{type:"primary",onClick:d,children:"Guardar"})})]})})},ce=async l=>{try{const{data:a}=await K.get("/almacen_producto");l(a)}catch(a){console.error("Error al obtener los almacenes:",a),l([])}},ie=({openModal:l,closeModal:a,reload:t,fase:u,status:o})=>{const[r]=p.useForm(),{id:s}=v(),[g,i]=n.useState([]),[f,h]=n.useState([]),[x,d]=n.useState([]),[j,c]=n.useState([]),[m,_]=n.useState(""),G=w();n.useEffect(()=>{switch(u){case 1:_("Corte"),N(s,i,r);break;case 2:_("Lavanderia"),z(s,i,r);break;case 3:_("Acabado"),q(s,i,r);break}ce(h),J(d),c(f.concat(x)),console.log("Tiendas y Almacenes: ",j)},[s,t]);const V=async()=>{try{const y=r.getFieldsValue().items;switch(u){case 1:await L(s,y),t();break;case 2:await T(s,y),t();break;case 3:const C=r.getFieldValue().id;await F(s,y,C),(o==2||o==3)&&G(`/lotes/${s}/almacen`),console.log(y),t();break;default:break}r.resetFields(),t(),a()}catch(y){console.error("Error al guardar:",y)}},B={textAlign:"center"},P={textAlign:"center"};return e.jsx(k,{forceRender:!0,getContainer:!1,styles:{header:{textAlign:"center"}},title:"ACABADOS RECIBIDOS",open:l,onCancel:a,footer:null,children:e.jsxs(p,{form:r,layout:"vertical",name:"changeStatusAcabado",style:{maxWidth:600,display:"flex",flexDirection:"column"},autoComplete:"off",children:[e.jsx(p.List,{name:"items",children:()=>e.jsx("div",{style:{display:"flex",flexDirection:"column",rowGap:20},children:g.map((y,C)=>e.jsxs($,{size:"small",title:`${m} ${C+1}`,style:B,children:[e.jsxs(D,{justify:"center",children:[e.jsxs(S,{span:24,style:P,children:[y.detallesCorte," "]}),e.jsx(S,{span:24,children:e.jsx(p.Item,{label:"Cantidad Recibida",name:[C,"cantidad_recibida"],rules:[{required:!0,message:"Ingrese una cantidad válida"}],children:e.jsx(M,{style:{width:"100%"},max:y.cantidad_recibida})})})]}),e.jsx(E,{type:"hidden",name:[C,"id"]})," "]},C))})}),e.jsx(A,{})," ",e.jsx(p.Item,{children:e.jsx(R,{type:"primary",onClick:V,children:"Guardar"})})]})})},de=({openModal:l,closeModal:a,reload:t})=>{const[u]=p.useForm(),{id:o}=v(),[r,s]=n.useState([]),[g,i]=n.useState([]);n.useEffect(()=>{Q("talleres",i),U(o,s,u)},[o,t]);const f={textAlign:"center"},h={textAlign:"center"},x=async()=>{try{const d=u.getFieldsValue().items;console.log("Taller Añadido:",d),await L(o,d),u.resetFields(),t(),a()}catch(d){console.error("Error al guardar:",d)}};return e.jsx(k,{forceRender:!0,getContainer:!1,title:"ASIGNAR TALLER AL CORTE",open:l,onCancel:a,footer:null,children:e.jsxs(p,{form:u,layout:"vertical",name:"addTaller",style:{maxWidth:600,display:"flex",flexDirection:"column"},autoComplete:"off",children:[e.jsx(p.List,{name:"items",children:()=>e.jsx("div",{style:{display:"flex",rowGap:16,flexDirection:"column"},children:r==null?void 0:r.map((d,j)=>e.jsxs($,{size:"small",title:`Corte ${d.corte_id}`,style:f,children:[e.jsxs(D,{justify:"center",children:[e.jsxs(S,{span:24,style:h,children:[d.datos_corte," "]}),e.jsx(S,{span:24,children:e.jsx(p.Item,{label:"Taller",name:[j,"taller_id"],rules:[{required:!0,message:"Seleccione un taller"}],children:e.jsx(O,{placeholder:"Seleccione el taller",children:g.map(c=>e.jsxs(O.Option,{value:c.trabajador_id,children:[`${c.nombre} ${c.ap_paterno} ${c.ap_materno}`," "]},`taller_${c.trabajador_id}`))})})})]}),e.jsx(E,{type:"hidden",name:[j,"corte_id"],value:d.corte_id})]},j))})}),e.jsx(A,{})," ",e.jsx(p.Item,{children:e.jsx(R,{type:"primary",onClick:x,children:"Crear"})})]})})},me="_status_3zrlh_1",ue="_statusIcon_3zrlh_25",pe="_text_3zrlh_57",b={status:me,statusIcon:ue,"status-1":"_status-1_3zrlh_33","status-2":"_status-2_3zrlh_41","status-3":"_status-3_3zrlh_49",text:pe},fe=({fase:l,status:a,reload:t})=>{const u=W(),[o,r]=n.useState(!1),[s,g]=n.useState(!1),[i,f]=n.useState(!1),{id:h}=v(),x=async()=>{a==0?u("Agrega un elemento"):l==1?a==1?f(!0):a==2&&(r(!0),t()):l==2?a==1?(await T(h),t()):a==2&&(r(!0),t()):l==3&&(a==1?(await F(h),await t()):a==2&&g(!0))},d=["Sin Datos","Iniciar","En Proceso","Finalizado"];return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:`${b.status} ${b[`status-${a}`]}`,onClick:x,children:[e.jsx("img",{className:b.statusIcon,src:"/svg/status/play.svg",alt:""}),e.jsx("h1",{className:b.text,children:d[a]}),"  "]}),e.jsx(le,{openModal:o,closeModal:()=>r(!1),reload:t,fase:l,status:a}),e.jsx(ie,{openModal:s,closeModal:()=>g(!1),reload:t,fase:l,status:a}),e.jsx(de,{openModal:i,closeModal:()=>f(!1),reload:t})]})},Ke=()=>{const{id:l}=v(),a=w(),[t,u]=n.useState(!1),[o,r]=n.useState(0),[s,g]=n.useState(0),i=[{title:"Corte",url:"corte",color:"#9481fe"},{title:"Lavandería",url:"lavanderia",color:"#49adfe"},{title:"Taller de Acabados Finales",url:"acabados",color:"#49adfe"},{title:"Almacén",url:"almacen",color:"#7bfe56"}],f=location.pathname.split("/").pop(),h=i.findIndex(c=>c.url===f),x=i.find(c=>c.url===f),d=x?x.color:"white";let j=Array(h+2).fill(d);return j.push(...Array(i.length-(h+1)).fill("white")),n.useEffect(()=>{X(l,o,g),Y(l,r)},[t,o,s]),e.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100%"},children:[e.jsx(A,{children:f.toUpperCase()}),e.jsx("div",{children:e.jsx("div",{className:I.loteIcons,children:i.map((c,m)=>e.jsx(Z,{title:c.title,children:e.jsx("div",{onClick:()=>{m<o&&a(`/lotes/${l}/${c.url}`)},className:I.loteIcon,style:{backgroundColor:j[m+1]},children:e.jsx("img",{className:I.svgLote,src:`/svg/lote/${m+1}.svg`,alt:c.title})})},m))})}),e.jsxs(ee,{wrap:!0,gap:"large",justify:"space-evenly",align:"flex-start",style:{width:"100%",flex:1,maxWidth:"1200px",margin:"0 auto",padding:"1rem"},children:[e.jsxs("div",{style:x!="almacen"?{flex:1,height:"100%"}:{flex:1},children:[e.jsx(H,{context:{reload:t,setReload:u}})," "]}),f!="almacen"?e.jsx("div",{children:e.jsx(fe,{fase:o,status:s,reload:()=>u(!t)})}):null]})]})};export{Ke as default};
