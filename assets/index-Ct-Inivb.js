const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/CortesTable-C0lSZNkc.js","assets/index-DnZSuapv.js","assets/index-D84L0m8O.css","assets/Producto-Cd6i44JA.js","assets/apiClient-DNqqoRi2.js","assets/Usuario-BLIord41.js","assets/moment-64TmN0UP.js","assets/index-eEjfzd7p.js","assets/ContextIsolator-X51Zuf7C.js","assets/useSize-DL9WfM8p.js","assets/button-DxAvYtf7.js","assets/EllipsisOutlined-BC2kcC9O.js","assets/useMergedState-xnIRtK6W.js","assets/index-OoAlQgr1.js","assets/row-Bgu54Vpq.js","assets/responsiveObserver-P31G7zPC.js","assets/index-CQoRxuqN.js","assets/ActionButton-HZPJWirw.js","assets/Skeleton-C8RXkADb.js","assets/index-CAw0ik1A.js","assets/TextArea-D6coABml.js","assets/CheckOutlined-CxFn5oU1.js","assets/DownOutlined-DfCZxesi.js","assets/index-ZS8OVZkw.js","assets/index-BRImeMB9.js","assets/Table-UylViyS0.js","assets/styleChecker-BPMTEHVB.js","assets/addEventListener-BGVn8IVC.js","assets/index-nq-gG-E2.js","assets/LeftOutlined-DUJeaJ5E.js","assets/index-DnZuPcqL.js","assets/index-8gkIUhhz.js","assets/index-BsZC5oSy.js","assets/gapSize-U1swVQyS.js","assets/scrollTo-DvbmuEp_.js","assets/useBreakpoint-CHVb293n.js","assets/index-CfhjOVlK.js","assets/EyeOutlined-Dgph3YEA.js","assets/index-CRStyn0e.js","assets/index-BLOaBrrf.js","assets/index-rbW2pF-2.js","assets/Tienda-DchRzPO6.js","assets/Lote-DgymCvQp.js","assets/LavanderiaTable-B8L0o5X8.js","assets/AcabadoTable-xT_IuQ_9.js"])))=>i.map(i=>d[i]);
import{j as t,e as C,r as c,ai as $}from"./index-DnZSuapv.js";import{T as B}from"./index-OoAlQgr1.js";import{a as d}from"./apiClient-DNqqoRi2.js";import{F as u}from"./index-eEjfzd7p.js";import{M as T}from"./index-CQoRxuqN.js";import{C as I}from"./index-BLOaBrrf.js";import{R as S,C as b}from"./row-Bgu54Vpq.js";import{T as z}from"./index-ZS8OVZkw.js";import{I as F}from"./index-CfhjOVlK.js";import{D as w}from"./index-DnZuPcqL.js";import{B as k}from"./button-DxAvYtf7.js";import{g as W}from"./Tienda-DchRzPO6.js";import{S as v}from"./index-CAw0ik1A.js";import{d as H}from"./Usuario-BLIord41.js";import{b as J,c as K}from"./Lote-DgymCvQp.js";const Q="_cardLoteIcons_fjyqf_1",U="_cardLoteIcon_fjyqf_1",X="_cardSvgLote_fjyqf_51",Y="_loteIcons_fjyqf_63",Z="_loteIcon_fjyqf_63",ee="_svgLote_fjyqf_109",A={cardLoteIcons:Q,cardLoteIcon:U,cardSvgLote:X,loteIcons:Y,loteIcon:Z,svgLote:ee},ae=({fase:r,setFase:e,faseTimeline:a,reload:s})=>{const n=["white","#9481fe","#49adfe","#ff7655","#7bfe56"];let o=Array(r+1).fill(n[r]);return o.push(...Array(4-r).fill("white")),t.jsx("div",{className:A.loteIcons,children:["Corte","Lavandería","Taller de Acabados Finales","Almacen"].map((i,l)=>t.jsx(B,{title:i,children:t.jsx("div",{onClick:()=>{l+1<=a&&l+1!=r&&(e(l+1),s())},className:A.loteIcon,style:{backgroundColor:o[l+1]},children:t.jsx("img",{className:A.svgLote,src:`/svg/lote/${l+1}.svg`,alt:i})})},l))})},Le=async(r,e)=>{var a;try{const s=await d.get(`/corte/lote/${r}`,{withCredentials:!0});e(s.data||[])}catch(s){((a=s.response)==null?void 0:a.status)===404?e([]):(console.error("Error al obtener el corte:",s),e([]))}},$e=async(r,e)=>{var a;try{const s=await d.get(`/corte/lote/${r}?tipo=diferido`,{withCredentials:!0});e(s.data||[])}catch(s){((a=s.response)==null?void 0:a.status)===404?e([]):(console.error("Error al obtener el corte:",s),e([]))}},Te=async(r,e)=>{e.detalles=e.detalles.map(s=>({cantidad_enviada:s.cantidad_enviada,talla:s.talla,taller_id:s.taller_id??null})),console.log(e);try{var a=await d.post(`/corte/create/array/${r}`,e);console.log(a)}catch(s){console.error("Error al añadir el corte:",s)}},P=async(r,e,a)=>{try{const n=(await d.get(`/corte/lote/${r}`,{withCredentials:!0})).data.map(o=>({detallesCorte:`Taller Asignado: ${o.taller} | Producto: ${o.producto} | Talla: ${o.talla}`,id:o.corte_id,cantidad_recibida:o.cantidad_enviada}));e(n),a.setFieldsValue({items:n})}catch(s){console.error("Error al obtener el corte:",s),e([]),a.setFieldsValue({items:[]})}},te=async(r,e,a)=>{try{const n=(await d.get(`/corte/lote/${r}`,{withCredentials:!0})).data.map(o=>({datos_corte:`Producto: ${o.producto} | Cantidad: ${o.cantidad_enviada} | Talla: ${o.talla}`,corte_id:o.corte_id,taller_id:o.taller_id}));e(n.length>0?n:[]),a.setFieldsValue({items:n.length>0?n:[]})}catch(s){console.error("Error al obtener el corte:",s),e([]),a.setFieldsValue({items:[]})}},Ie=async(r,e)=>{if(e===1)try{await d.put(`/corte/desactivar/${r}`)}catch(a){console.error("Error al eliminar el corte:",a)}},O=async(r,e=null)=>{try{e||(e=(await d.get(`/corte/lote/${r}`,{withCredentials:!0})).data);const a=e.map(s=>({corte_id:s.id||s.corte_id,cantidad_recibida:s.cantidad_recibida,taller_id:s.taller_id}));await d.put(`/corte/sgte/lote/${r}`,{detalles:a},{withCredentials:!0})}catch(a){console.error("Error al cambiar el estado del corte:",a)}},Fe=async(r,e)=>{try{const a=await d.get(`/lavanderia/lote/${r}`);e(a.data)}catch(a){a.response&&a.response.status===404?e([]):(console.error("Error al obtener lavandería:",a),e([]))}},ke=async(r,e)=>{try{return await d.post(`/lavanderia/create/array/${r}`,e,{withCredentials:!0}),"Lavandería añadida correctamente"}catch(a){return console.error("Error al añadir lavandería:",a),"Error al añadir lavandería"}},q=async(r,e,a)=>{try{const o=(await d.get(`/lavanderia/lote/${r}`)).data.map(i=>({id:i.lavanderia_id,cantidad_recibida:i.cantidad_enviada}));e(o),a.setFieldsValue({items:o})}catch(s){s.response&&s.response.status===404?(console.error(`Lavandería con ID ${r} no encontrada (404).`),e([]),a.setFieldsValue({items:[]})):(console.error("Error al obtener detalles de lavandería:",s),e([]),a.setFieldsValue({items:[]}))}},R=async(r,e=null)=>{try{e||(e=(await d.get(`/lavanderia/lote/${r}`,{withCredentials:!0})).data);const s={detalles:e.map(n=>({lavanderia_id:n.id||n.lavanderia_id,cantidad_recibida:n.cantidad_recibida}))};return console.log("Lavandería:",s),await d.put(`/lavanderia/sgte/lote/${r}`,s),"Estado actualizado correctamente"}catch(a){return console.error("Error en la función changeStatusLavanderia:",a),`Error: ${a.message}`}},Oe=async(r,e)=>{try{const a=await d.get(`/taller/lote/${r}`);e(a.data)}catch(a){a.response&&a.response.status===404?e([]):(console.error("Error al obtener acabados por lote:",a),e([]))}},D=async(r,e,a)=>{try{const o=(await d.get(`/taller/lote/${r}`)).data.map(i=>({id:i.acabado_id,cantidad_recibida:i.cantidad_enviada}));e(o),a.setFieldsValue({items:o})}catch(s){s.response&&s.response.status===404?(console.error(`Acabado con ID ${r} no encontrado (404).`),e([]),a.setFieldsValue({items:[]})):(console.error("Error al obtener detalles de acabado:",s),e([]),a.setFieldsValue({items:[]}))}},V=async(r,e=null,a=null)=>{try{e||(e=(await d.get(`/taller/lote/${r}`)).data);const n={detalles:e.map(o=>({acabado_id:o.id||o.acabado_id,cantidad_recibida:o.cantidad_recibida}))};return await d.put(`/taller/sgte/${r}`,n,{params:a}),"Estado actualizado correctamente"}catch(s){return console.error("Error al cambiar estado del acabado:",s),`Error: ${s.message}`}},se=({openModal:r,closeModal:e,reload:a,fase:s})=>{const[n]=u.useForm(),{id:o}=C(),[i,l]=c.useState([]),[f,y]=c.useState("");c.useEffect(()=>{switch(s){case 1:y("Corte"),P(o,l,n);break;case 2:y("Lavanderia"),q(o,l,n);break;case 3:y("Acabado"),D(o,l,n);break}},[o,a]);const x=async()=>{try{const p=n.getFieldsValue().items;switch(console.log("Values:",p),s){case 1:await O(o,p),a();break;case 2:await R(o,p),a();break;case 3:await V(o,p),a();break;default:a();break}n.resetFields(),a(),e()}catch(p){console.error("Error al guardar:",p)}},_={textAlign:"center"},m={textAlign:"center"};return t.jsx(T,{forceRender:!0,getContainer:!1,styles:{header:{textAlign:"center"}},title:"MERCADERÍA RECIBIDA",open:r,onCancel:e,footer:null,children:t.jsxs(u,{form:n,layout:"vertical",name:"addProductos",style:{maxWidth:600,display:"flex",flexDirection:"column"},autoComplete:"off",children:[t.jsx(u.List,{name:"items",children:()=>t.jsx("div",{style:{display:"flex",flexDirection:"column",rowGap:20},children:i.map((p,g)=>t.jsxs(I,{size:"small",title:`${f} ${g+1}`,style:_,children:[t.jsxs(S,{justify:"center",children:[t.jsxs(b,{span:24,style:m,children:[p.detallesCorte," "]}),t.jsx(b,{span:24,children:t.jsx(u.Item,{label:"Cantidad Recibida",name:[g,"cantidad_recibida"],rules:[{required:!0,message:"Ingrese una cantidad válida"}],children:t.jsx(z,{style:{width:"100%"},max:p.cantidad_recibida})})})]}),t.jsx(F,{type:"hidden",name:[g,"id"]})," "]},g))})}),t.jsx(w,{})," ",t.jsx(u.Item,{children:t.jsx(k,{type:"primary",onClick:x,children:"Guardar"})})]})})},re=async r=>{try{const{data:e}=await d.get("/almacen_productos");r(e)}catch(e){console.error("Error al obtener los almacenes:",e),r([])}},oe=({openModal:r,closeModal:e,reload:a,fase:s})=>{const[n]=u.useForm(),{id:o}=C(),[i,l]=c.useState([]),[f,y]=c.useState([]),[x,_]=c.useState([]),[m,p]=c.useState([]),[g,E]=c.useState("");c.useEffect(()=>{switch(s){case 1:E("Corte"),P(o,l,n);break;case 2:E("Lavanderia"),q(o,l,n);break;case 3:E("Acabado"),D(o,l,n);break}re(y),W(_),p(f.concat(x)),console.log("Tiendas y Almacenes: ",m)},[o,a]);const M=async()=>{try{const h=n.getFieldsValue().items;switch(s){case 1:await O(o,h),a();break;case 2:await R(o,h),a();break;case 3:const j=n.getFieldValue().id;await V(o,h,j),a();break;default:break}n.resetFields(),a(),e()}catch(h){console.error("Error al guardar:",h)}},N={textAlign:"center"},G={textAlign:"center"};return t.jsx(T,{forceRender:!0,getContainer:!1,styles:{header:{textAlign:"center"}},title:"ACABADOS RECIBIDOS",open:r,onCancel:e,footer:null,children:t.jsxs(u,{form:n,layout:"vertical",name:"changeStatusAcabado",style:{maxWidth:600,display:"flex",flexDirection:"column"},autoComplete:"off",children:[t.jsx(u.Item,{name:"id",children:t.jsx(v,{children:m.map((h,j)=>h.tienda?t.jsxs(v.Option,{value:`tienda_id=${h.tienda_id}`,children:[h.tienda," "]},j):t.jsxs(v.Option,{value:`almacen_id=${h.almacen_id}`,children:[h.almacen," "]},j))})}),t.jsx(u.List,{name:"items",children:()=>t.jsx("div",{style:{display:"flex",flexDirection:"column",rowGap:20},children:i.map((h,j)=>t.jsxs(I,{size:"small",title:`${g} ${j+1}`,style:N,children:[t.jsxs(S,{justify:"center",children:[t.jsxs(b,{span:24,style:G,children:[h.detallesCorte," "]}),t.jsx(b,{span:24,children:t.jsx(u.Item,{label:"Cantidad Recibida",name:[j,"cantidad_recibida"],rules:[{required:!0,message:"Ingrese una cantidad válida"}],children:t.jsx(z,{style:{width:"100%"},max:h.cantidad_recibida})})})]}),t.jsx(F,{type:"hidden",name:[j,"id"]})," "]},j))})}),t.jsx(w,{})," ",t.jsx(u.Item,{children:t.jsx(k,{type:"primary",onClick:M,children:"Guardar"})})]})})},ne=({openModal:r,closeModal:e,reload:a})=>{const[s]=u.useForm(),{id:n}=C(),[o,i]=c.useState([]),[l,f]=c.useState([]);c.useEffect(()=>{H("talleres",f),te(n,i,s)},[n,a]);const y={textAlign:"center"},x={textAlign:"center"},_=async()=>{try{const m=s.getFieldsValue().items;console.log("Taller Añadido:",m),await O(n,m),s.resetFields(),a(),e()}catch(m){console.error("Error al guardar:",m)}};return t.jsx(T,{forceRender:!0,getContainer:!1,title:"ASIGNAR TALLER AL CORTE",open:r,onCancel:e,footer:null,children:t.jsxs(u,{form:s,layout:"vertical",name:"addTaller",style:{maxWidth:600,display:"flex",flexDirection:"column"},autoComplete:"off",children:[t.jsx(u.List,{name:"items",children:()=>t.jsx("div",{style:{display:"flex",rowGap:16,flexDirection:"column"},children:o==null?void 0:o.map((m,p)=>t.jsxs(I,{size:"small",title:`Corte ${m.corte_id}`,style:y,children:[t.jsxs(S,{justify:"center",children:[t.jsxs(b,{span:24,style:x,children:[m.datos_corte," "]}),t.jsx(b,{span:24,children:t.jsx(u.Item,{label:"Taller",name:[p,"taller_id"],rules:[{required:!0,message:"Seleccione un taller"}],children:t.jsx(v,{placeholder:"Seleccione el taller",children:l.map(g=>t.jsxs(v.Option,{value:g.trabajador_id,children:[`${g.nombre} ${g.ap_paterno} ${g.ap_materno}`," "]},`taller_${g.trabajador_id}`))})})})]}),t.jsx(F,{type:"hidden",name:[p,"corte_id"],value:m.corte_id})]},p))})}),t.jsx(w,{})," ",t.jsx(u.Item,{children:t.jsx(k,{type:"primary",onClick:_,children:"Crear"})})]})})},ce="_status_pyugy_1",L={status:ce,"status-1":"_status-1_pyugy_33","status-2":"_status-2_pyugy_41","status-3":"_status-3_pyugy_49"},le=({fase:r,status:e,reload:a})=>{const[s,n]=c.useState(!1),[o,i]=c.useState(!1),[l,f]=c.useState(!1),{id:y}=C(),x=async()=>{e==0?alert("agrega un elemento"):r==1?e==1?f(!0):e==2&&(n(!0),a()):r==2?e==1?(await R(y),a()):e==2&&(n(!0),a()):r==3&&(e==1?(await V(y),await a()):e==2&&i(!0))},_=["","Iniciar","En Proceso","Finalizado"];return t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:`${L.status} ${L[`status-${e}`]}`,onClick:x,children:[t.jsx("img",{className:L.statusIcon,src:"/svg/status/play.svg",alt:""}),t.jsx("h1",{children:_[e]}),"  "]}),t.jsx(se,{openModal:s,closeModal:()=>n(!1),reload:a,fase:r}),t.jsx(oe,{openModal:o,closeModal:()=>i(!1),reload:a,fase:r}),t.jsx(ne,{openModal:l,closeModal:()=>f(!1),reload:a})]})},ie=c.lazy(()=>$(()=>import("./CortesTable-C0lSZNkc.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42]))),de=c.lazy(()=>$(()=>import("./LavanderiaTable-B8L0o5X8.js"),__vite__mapDeps([43,1,2,4,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,36,37,25,26,27,28,29,30,31,32,33,34,35,38,39,40,41,5,6,42]))),ue=c.lazy(()=>$(()=>import("./AcabadoTable-xT_IuQ_9.js"),__vite__mapDeps([44,1,2,25,12,9,26,11,27,19,15,20,8,10,21,22,28,29,30,13,31,32,33,34,35,36,37,4,7,14,16,17,18,39,40,23,41,5,6,42]))),me=()=>{const{id:r}=C(),[e,a]=c.useState(!1),[s,n]=c.useState(0),[o,i]=c.useState(0),[l,f]=c.useState(0),y=async()=>{s>0&&(await J(r,s,f),console.log(l))},x=async()=>{await K(r,n,i),await y()};c.useEffect(()=>{x()},[]),c.useEffect(()=>{y()},[e]);const _=()=>t.jsxs("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"},children:[t.jsx("img",{src:"/img/loading/loading.gif"})," "]}),m=()=>{switch(s){case 1:return t.jsx(ie,{reload:()=>a(!e),status:l});case 2:return t.jsx(de,{reload:()=>a(!e),status:l});case 3:return t.jsx(ue,{reload:()=>a(!e),status:l});default:return t.jsx(_,{})}};return t.jsxs(t.Fragment,{children:[t.jsx(w,{children:"DETALLES DEL LOTE"}),t.jsx(ae,{fase:s,setFase:n,faseTimeline:o,reload:()=>a(!e)}),t.jsxs(S,{children:[t.jsx(b,{span:18,children:t.jsx(c.Suspense,{fallback:t.jsx(_,{}),children:m()})}),t.jsx(b,{span:6,children:t.jsx(le,{fase:s,status:l,reload:()=>a(!e)})})]})]})},Re=Object.freeze(Object.defineProperty({__proto__:null,default:me},Symbol.toStringTag,{value:"Module"}));export{Te as a,$e as b,ke as c,Ie as d,Fe as e,Oe as f,Le as g,Re as i};
