import{F as h,c as v,r as n,u as w,j as e,X as L,S,a3 as N,I as F,B as T,Z as O,a as W,al as H,aF as U}from"./index-Bunp8VmX.js";import{g as z,c as k,a as X}from"./Corte-DVOiRUog.js";import{g as q,c as $}from"./Lavanderia-BA1Q3z-0.js";import{g as M,c as D}from"./Acabado-Dsv_Cepw.js";import{M as E}from"./index-DCZRlB0p.js";import{C as R}from"./index-BD1DMr01.js";import{D as A}from"./index-B_8r9Za8.js";import{g as Z}from"./Tienda-iwZDkmbP.js";import{A as J}from"./ApiClient-CwTlTqVt.js";import{g as K}from"./Usuario-C8RuNjFp.js";import{g as Q,a as Y}from"./Lote-D_Ldw2rP.js";import{F as ee}from"./index-BJT4Palo.js";import"./ActionButton-DynUVMgy.js";import"./index-BkpqA939.js";import"./Skeleton-DQ75DhjH.js";import"./index-B00MmLCC.js";import"./Dropdown-CAg5ab4S.js";import"./moment-C5S46NFB.js";import"./gapSize-U1swVQyS.js";const te="_cardLoteIcons_fjyqf_1",ae="_cardLoteIcon_fjyqf_1",se="_cardSvgLote_fjyqf_51",re="_loteIcons_fjyqf_63",le="_loteIcon_fjyqf_63",ne="_svgLote_fjyqf_109",I={cardLoteIcons:te,cardLoteIcon:ae,cardSvgLote:se,loteIcons:re,loteIcon:le,svgLote:ne},oe=({openModal:o,closeModal:a,reload:t,fase:m,status:l})=>{const[r]=h.useForm(),{id:s}=v(),[g,i]=n.useState([]),[x,f]=n.useState(""),p=w();n.useEffect(()=>{switch(m){case 1:f("Corte"),z(s,i,r);break;case 2:f("Lavanderia"),q(s,i,r);break;case 3:f("Acabado"),M(s,i,r);break}},[s,t]);const d=async()=>{try{const u=r.getFieldsValue().items;switch(console.log("Values:",u),m){case 1:await k(s,u),(l==2||l==3)&&p(`/lotes/${s}/lavanderia`),t();break;case 2:await $(s,u),(l==2||l==3)&&p(`/lotes/${s}/acabados`),t();break;case 3:await D(s,u),(l==2||l==3)&&p(`/lotes/${s}/almacen`),t();break;default:t();break}r.resetFields(),t(),a()}catch(u){console.error("Error al guardar:",u)}},j={textAlign:"center"},c={textAlign:"center"};return e.jsx(E,{forceRender:!0,getContainer:!1,styles:{header:{textAlign:"center"}},title:"MERCADERÍA RECIBIDA",open:o,onCancel:a,footer:null,children:e.jsxs(h,{form:r,layout:"vertical",name:"addProductos",style:{maxWidth:600,display:"flex",flexDirection:"column"},autoComplete:"off",children:[e.jsx(h.List,{name:"items",children:()=>e.jsx("div",{style:{display:"flex",flexDirection:"column",rowGap:20},children:g.map((u,_)=>e.jsxs(R,{size:"small",title:`${x} ${_+1}`,style:j,children:[e.jsxs(L,{justify:"center",children:[e.jsxs(S,{span:24,style:c,children:[u.detallesCorte," "]}),e.jsx(S,{span:24,children:e.jsx(h.Item,{label:"Cantidad Recibida",name:[_,"cantidad_recibida"],rules:[{required:!0,message:"Ingrese una cantidad válida"}],children:e.jsx(N,{style:{width:"100%"},max:u.cantidad_recibida})})})]}),e.jsx(F,{type:"hidden",name:[_,"id"]})," "]},_))})}),e.jsx(A,{})," ",e.jsx(h.Item,{children:e.jsx(T,{type:"primary",onClick:d,children:"Guardar"})})]})})},ce=async o=>{try{const{data:a}=await J.get("/almacen_producto");o(a)}catch(a){console.error("Error al obtener los almacenes:",a),o([])}},ie=({openModal:o,closeModal:a,reload:t,fase:m,status:l})=>{const[r]=h.useForm(),{id:s}=v(),[g,i]=n.useState([]),[x,f]=n.useState([]),[p,d]=n.useState([]),[j,c]=n.useState([]),[u,_]=n.useState(""),G=w();n.useEffect(()=>{switch(m){case 1:_("Corte"),z(s,i,r);break;case 2:_("Lavanderia"),q(s,i,r);break;case 3:_("Acabado"),M(s,i,r);break}ce(f),Z(d),c(x.concat(p)),console.log("Tiendas y Almacenes: ",j)},[s,t]);const V=async()=>{try{const y=r.getFieldsValue().items;switch(m){case 1:await k(s,y),t();break;case 2:await $(s,y),t();break;case 3:const C=r.getFieldValue().id;await D(s,y,C),(l==2||l==3)&&G(`/lotes/${s}/almacen`),console.log(y),t();break;default:break}r.resetFields(),t(),a()}catch(y){console.error("Error al guardar:",y)}},B={textAlign:"center"},P={textAlign:"center"};return e.jsx(E,{forceRender:!0,getContainer:!1,styles:{header:{textAlign:"center"}},title:"ACABADOS RECIBIDOS",open:o,onCancel:a,footer:null,children:e.jsxs(h,{form:r,layout:"vertical",name:"changeStatusAcabado",style:{maxWidth:600,display:"flex",flexDirection:"column"},autoComplete:"off",children:[e.jsx(h.List,{name:"items",children:()=>e.jsx("div",{style:{display:"flex",flexDirection:"column",rowGap:20},children:g.map((y,C)=>e.jsxs(R,{size:"small",title:`${u} ${C+1}`,style:B,children:[e.jsxs(L,{justify:"center",children:[e.jsxs(S,{span:24,style:P,children:[y.detallesCorte," "]}),e.jsx(S,{span:24,children:e.jsx(h.Item,{label:"Cantidad Recibida",name:[C,"cantidad_recibida"],rules:[{required:!0,message:"Ingrese una cantidad válida"}],children:e.jsx(N,{style:{width:"100%"},max:y.cantidad_recibida})})})]}),e.jsx(F,{type:"hidden",name:[C,"id"]})," "]},C))})}),e.jsx(A,{})," ",e.jsx(h.Item,{children:e.jsx(T,{type:"primary",onClick:V,children:"Guardar"})})]})})},de=({openModal:o,closeModal:a,reload:t})=>{const[m]=h.useForm(),{id:l}=v(),[r,s]=n.useState([]),[g,i]=n.useState([]);n.useEffect(()=>{K("talleres",i),X(l,s,m)},[l,t]);const x={textAlign:"center"},f={textAlign:"center"},p=async()=>{try{const d=m.getFieldsValue().items;console.log("Taller Añadido:",d),await k(l,d),m.resetFields(),t(),a()}catch(d){console.error("Error al guardar:",d)}};return e.jsx(E,{forceRender:!0,getContainer:!1,title:"ASIGNAR TALLER AL CORTE",open:o,onCancel:a,footer:null,children:e.jsxs(h,{form:m,layout:"vertical",name:"addTaller",style:{maxWidth:600,display:"flex",flexDirection:"column"},autoComplete:"off",children:[e.jsx(h.List,{name:"items",children:()=>e.jsx("div",{style:{display:"flex",rowGap:16,flexDirection:"column"},children:r==null?void 0:r.map((d,j)=>e.jsxs(R,{size:"small",title:`Corte ${d.corte_id}`,style:x,children:[e.jsxs(L,{justify:"center",children:[e.jsxs(S,{span:24,style:f,children:[d.datos_corte," "]}),e.jsx(S,{span:24,children:e.jsx(h.Item,{label:"Taller",name:[j,"taller_id"],rules:[{required:!0,message:"Seleccione un taller"}],children:e.jsx(O,{placeholder:"Seleccione el taller",children:g.map(c=>e.jsxs(O.Option,{value:c.trabajador_id,children:[`${c.nombre} ${c.ap_paterno} ${c.ap_materno}`," "]},`taller_${c.trabajador_id}`))})})})]}),e.jsx(F,{type:"hidden",name:[j,"corte_id"],value:d.corte_id})]},j))})}),e.jsx(A,{})," ",e.jsx(h.Item,{children:e.jsx(T,{type:"primary",onClick:p,children:"Crear"})})]})})},ue="_status_3zrlh_1",me="_statusIcon_3zrlh_25",he="_text_3zrlh_57",b={status:ue,statusIcon:me,"status-1":"_status-1_3zrlh_33","status-2":"_status-2_3zrlh_41","status-3":"_status-3_3zrlh_49",text:he},xe=({fase:o,status:a,reload:t})=>{const m=W(),[l,r]=n.useState(!1),[s,g]=n.useState(!1),[i,x]=n.useState(!1),{id:f}=v(),p=async()=>{a==0?m("Agrega un elemento"):o==1?a==1?x(!0):a==2&&(r(!0),t()):o==2?a==1?(await $(f),t()):a==2&&(r(!0),t()):o==3&&(a==1?(await D(f),await t()):a==2&&g(!0))},d=["Sin Datos","Iniciar","En Proceso","Finalizado"];return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:`${b.status} ${b[`status-${a}`]}`,onClick:p,children:[e.jsx("img",{className:b.statusIcon,src:"/svg/status/play.svg",alt:""}),e.jsx("h1",{className:b.text,children:d[a]}),"  "]}),e.jsx(oe,{openModal:l,closeModal:()=>r(!1),reload:t,fase:o,status:a}),e.jsx(ie,{openModal:s,closeModal:()=>g(!1),reload:t,fase:o,status:a}),e.jsx(de,{openModal:i,closeModal:()=>x(!1),reload:t})]})},Ee=()=>{const{id:o}=v(),a=w(),[t,m]=n.useState(!1),[l,r]=n.useState(0),[s,g]=n.useState(0),i=[{title:"Corte",url:"corte",color:"#9481fe"},{title:"Lavandería",url:"lavanderia",color:"#49adfe"},{title:"Taller de Acabados Finales",url:"acabados",color:"#49adfe"},{title:"Almacén",url:"almacen",color:"#7bfe56"}],x=location.pathname.split("/").pop(),f=i.findIndex(c=>c.url===x),p=i.find(c=>c.url===x),d=p?p.color:"white";let j=Array(f+2).fill(d);return j.push(...Array(i.length-(f+1)).fill("white")),n.useEffect(()=>{Q(o,l,g),Y(o,r)},[t,l,s]),e.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100%"},children:[e.jsx(A,{children:x.toUpperCase()}),e.jsx("div",{children:e.jsx("div",{className:I.loteIcons,children:i.map((c,u)=>e.jsx(H,{title:c.title,children:e.jsx("div",{onClick:()=>{u<l&&a(`/lotes/${o}/${c.url}`)},className:I.loteIcon,style:{backgroundColor:j[u+1]},children:e.jsx("img",{className:I.svgLote,src:`/svg/lote/${u+1}.svg`,alt:c.title})})},u))})}),e.jsxs(ee,{wrap:!0,gap:"large",justify:"space-evenly",align:"flex-start",style:{width:"100%",flex:1,maxWidth:"1200px",margin:"0 auto",padding:"1rem"},children:[e.jsxs("div",{style:p!="almacen"?{flex:1,height:"100%"}:{flex:1},children:[e.jsx(U,{context:{reload:t,setReload:m}})," "]}),x!="almacen"?e.jsx("div",{children:e.jsx(xe,{fase:l,status:s,reload:()=>m(!t)})}):null]})]})};export{Ee as default};
