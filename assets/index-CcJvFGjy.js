import{F as L,r as a,j as e,Z as C,X as y,S as d,B as S,L as A,al as E}from"./index-Bunp8VmX.js";import{b as k,c as O}from"./Lote-D_Ldw2rP.js";import{f as w}from"./Tela-_AUdno0v.js";import{a as R}from"./Producto-BhDx9a2R.js";import{M}from"./index-DCZRlB0p.js";import{D as b}from"./index-B_8r9Za8.js";import{T as q}from"./index-DokvF9RQ.js";import{F as D}from"./index-BJT4Palo.js";import{C as T}from"./index-BD1DMr01.js";import{F as $}from"./index-qnTMOKQ7.js";import{R as B}from"./index-B00MmLCC.js";import"./ApiClient-CwTlTqVt.js";import"./ActionButton-DynUVMgy.js";import"./index-BkpqA939.js";import"./Skeleton-DQ75DhjH.js";import"./styleChecker-BYYi54FN.js";import"./gapSize-U1swVQyS.js";import"./scrollTo-CK3_7m1G.js";import"./Dropdown-CAg5ab4S.js";const N=({openModal:x,closeModal:p,reload:h})=>{const{Title:u}=q,[m]=L.useForm(),[j,g]=a.useState([]),[l,o]=a.useState({}),[c,i]=a.useState("");a.useEffect(()=>{R(g)},[]),a.useEffect(()=>{const t=r=>{r.key==="Enter"?c.trim()!==""&&(w(c).then(s=>{s&&(Object.values(l).flat().some(({tela_id:n})=>s.tela_id===n)||o(n=>({...n,[s.tipo]:[...n[s.tipo]||[],s]})))}),i("")):i(s=>s+r.key)};return document.addEventListener("keypress",t),()=>{document.removeEventListener("keypress",t)}},[c]);const f=Object.values(l).flat().map(({tela_id:t})=>t).join(","),v=Object.values(l).flat().reduce((t,{metraje:r})=>t+Number(r),0).toFixed(2),F=(t,r)=>{o(s=>({...s,[r]:s[r].filter(n=>n.tela_id!==t)}))};return e.jsx(M,{title:"Nuevo Lote",open:x,onCancel:()=>p(!1),okText:"CREAR",onOk:m.submit,centered:!0,width:400,children:e.jsxs(L,{form:m,layout:"vertical",onFinish:async t=>{await k(t,f,v),i(""),o({}),m.resetFields(),h(),p(!1)},children:[e.jsx(L.Item,{name:"productos",label:"Productos",rules:[{required:!0,message:"Seleccione al menos un producto"}],children:e.jsx(C,{mode:"multiple",placeholder:"Seleccione productos",children:j.map((t,r)=>e.jsx(C.Option,{value:t.producto_id,children:t.nombre},r))})}),e.jsx(b,{}),e.jsxs(y,{gutter:16,justify:"center",align:"middle",children:[e.jsxs(d,{span:24,style:{textAlign:"center"},children:[e.jsx(u,{style:{color:"white"},level:3,children:"Telas"}),e.jsxs("span",{style:{color:"white"},children:["METRAJE USADO: ",v]})]}),e.jsx(d,{span:24,children:Object.entries(l).map(([t,r])=>e.jsxs(y,{style:{padding:"10px 20px",backgroundColor:"#1e1e2f",borderRadius:"8px"},children:[e.jsx(d,{span:6,style:{textAlign:"center",color:"#fff",textTransform:"uppercase"},children:e.jsxs("span",{style:{fontSize:"1rem",fontWeight:"bold"},children:[t,":"]})}),e.jsx(d,{span:18,children:e.jsx(y,{gutter:[0,8],justify:"end",children:r.map((s,n)=>e.jsxs(e.Fragment,{children:[e.jsx(d,{span:24,style:{textAlign:"right",color:"#fff",paddingLeft:"15px"},children:e.jsxs("span",{children:[e.jsxs("strong",{children:["CODIGO TELA: ",s.codigo_tela]})," ","METRAJE: ",s.metraje," M"]})},n),e.jsx(d,{children:e.jsx(S,{onClick:()=>F(s.tela_id,t),children:"X"})})]}))})})]},t))})]})]})})},P="_cardLoteIcons_fjyqf_1",J="_cardLoteIcon_fjyqf_1",X="_cardSvgLote_fjyqf_51",z="_loteIcons_fjyqf_63",G="_loteIcon_fjyqf_63",U="_svgLote_fjyqf_109",_={cardLoteIcons:P,cardLoteIcon:J,cardSvgLote:X,loteIcons:z,loteIcon:G,svgLote:U},{Meta:I}=T,V=()=>{const[x,p]=a.useState([]),[h,u]=a.useState(!1),m=["white","#9481fe","#49adfe","#ff7655","#7bfe56"],[j,g]=a.useState(!1),l=[{title:"Corte",url:"corte"},{title:"Lavandería",url:"lavanderia"},{title:"Taller de Acabados Finales",url:"acabados"},{title:"Almacén",url:"almacen"}];return a.useEffect(()=>{O(p)},[j]),e.jsxs(e.Fragment,{children:[e.jsx(D,{wrap:!0,gap:"middle",justify:"center",children:x.map(o=>{const c=Array(o.estado+1).fill(m[o.estado]);return c.push(...Array(4-o.estado).fill("white")),e.jsx(A,{to:`/lotes/${o.lote_id}/${l[o.estado-1].url}`,style:{textDecoration:"none"},children:e.jsxs(T,{style:{width:"300px",textAlign:"center"},title:`LOTE ${o.lote_id}`,children:[e.jsx(I,{title:`Fecha de Creación: ${o.fecha_creacion}`}),e.jsx("br",{}),e.jsx(I,{title:`Cantidad Total: ${o.cantidad_total}`}),e.jsx("div",{className:_.cardLoteIcons,children:l.map((i,f)=>e.jsx(E,{title:i.title,children:e.jsx("div",{className:_.cardLoteIcon,style:{backgroundColor:c[f+1]},children:e.jsx("img",{className:_.cardSvgLote,src:`/svg/lote/${f+1}.svg`,alt:i.title})})},f))})]})},o.lote_id)})}),e.jsx($,{tooltip:"Añadir Lote",icon:e.jsx(B,{}),onClick:()=>u(!0)}),e.jsx(N,{openModal:h,closeModal:()=>u(!1),reload:()=>g(!j)})]})},pe=()=>e.jsxs(e.Fragment,{children:[e.jsx(b,{style:{textTransform:"uppercase"},children:" Lotes "}),e.jsx(V,{})]});export{pe as default};
